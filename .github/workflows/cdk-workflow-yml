name: CDK CI/CD

on:
  push:
    branches:
      - main
    paths:
      - 'FamilyVaultCdk/**'

jobs:
  cdk-job:
    name: CDK CI/CD
    runs-on: ubuntu-latest
    steps:
    - name: Call CDK API Gateway
      run: |
        curl -X POST \
          -H "Content-Type: application/json" \
          -H "Authorization: ${{ secrets.AUTHORIZATION_KEY }}" \
          -d '{"action": "trigger"}' \
          ${{ secrets.APIGATEWAY_WEBHOOK_URL }}/cdk
